<!doctype html>
<html>
<head>
    <title>Javascript Countdown</title>
    <link rel="stylesheet" href="/css/testpages.css">

    <!-- HEAD -->

</head>

<body>

<div class="page-body">


    <div class="page-navigation">
        <a href="/index.html">Index</a>
    </div>

    <h1>Javascript Countdown</h1>

    <div class="explanation">
        <p>This page below contains text which is controlled by JavaScript running in the background.
            The timer starts automatically but can be configured and controlled by the GUI.
        </p>
    </div>

    <div class="centered">
        <div class="countdown-timer">
            <p id="javascript_countdown_time">01:01:12</p>
        </div>

        <div class="countdown-controls">
            <button class="styled-click-button" id="start-timer">Start Timer</button>
            <button class="styled-click-button" id="stop-timer">Stop Timer</button>
            <button class="styled-click-button" id="clear-timer">Clear Timer</button>
        </div>

        <div class="timer-reset">
            <label for="timer-seconds">Seconds</label>
            <input type="number" id="timer-seconds" value="3672">
            <button class="styled-click-button" id="reset-timer">Reset Timer</button>
        </div>
    </div>


    <div class="page-footer">
        <p><a target="_blank" rel="noopener noreferrer" href="https://eviltester.com">EvilTester.com</a>,
            <a target="_blank" rel="noopener noreferrer" href="https://compendiumdev.co.uk">Compendium Developments</a></p>
    </div>

</div>

<!-- BODY END -->

<script type="text/javascript">

    function SecondsFormatter(){
        var seconds;

        this.forValue = function (aValue){
            seconds = aValue;
            return this;
        }

        function add_leading_zero( aNumber ) {
            var strung = aNumber.toString();
            return (strung.length < 2) ? "0" + strung : strung;
        }

        this.asHHMMss = function () {

            var calculatedSeconds = seconds % 60;
            var calculatedMinutes = Math.floor(seconds / 60) % 60;
            var calculatedHours = Math.floor(seconds / 3600);

            var secondsDisplay = add_leading_zero( calculatedSeconds );
            var minutesDisplay = add_leading_zero( calculatedMinutes );
            var hoursDisplay = add_leading_zero( calculatedHours );

            return hoursDisplay + ':' + minutesDisplay + ':' + secondsDisplay;
        }
    }

    function CountDown() {

        var time_left = 0;
        var timeupMessage = 'Time Up!';
        var everyMillis = 1000;

        function show_time_left() {

            var timeDisplay = timeupMessage;

            if(time_left > 0){
                timeDisplay = new SecondsFormatter().forValue(time_left).asHHMMss();
            }

            document.getElementById('javascript_countdown_time').innerHTML = timeDisplay;
        }

        function advanceTime(){
            time_left = time_left - (everyMillis/1000);
            show_time_left();
        }

        var timer=null;

        this.startTimer = function (){
            if(timer == null && time_left > 0) {
                timer = setInterval(advanceTime, everyMillis);
            }
        }

        this.stopTimer = function(){
            if(timer != null) {
                clearInterval(timer);
                timer=null;
            }
        }

        this.clearTimer = function(){
            this.stopTimer();
            time_left = 0;
            show_time_left();
        }

        this.resetTimer = function(seconds){
            if(isNaN(seconds)){
                return;
            }
            time_left = seconds;
            show_time_left();
        }

        this.start = function(seconds){
            this.stopTimer();
            this.resetTimer(seconds);
            this.startTimer();
        };


    };

    var javascript_countdown = new CountDown();
    javascript_countdown.start(3672);
    document.getElementById("start-timer").addEventListener("click", function(){javascript_countdown.startTimer()});
    document.getElementById("stop-timer").addEventListener("click", function(){javascript_countdown.stopTimer()})
    document.getElementById("clear-timer").addEventListener("click", function(){javascript_countdown.clearTimer()})
    document.getElementById("reset-timer").addEventListener("click",
        function(){
            javascript_countdown.resetTimer(parseInt(document.getElementById("timer-seconds").value));
        })
</script>

</body>
</html>